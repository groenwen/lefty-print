import{M as k}from"./modal.b36b2b3b.js";import{_ as f,o as l,b as d,d as e,t as p,B as r,D as h,r as b,y,F as m,v as w,e as M,f as v}from"./index.d4337185.js";import"./selector-engine.f8e2a3c7.js";import"./component-functions.080cc925.js";const g={data(){return{myModal:"",innIsNew:!1,innCoupon:{is_enabled:1}}},props:{isNew:{type:Boolean},couponItem:{type:Object}},watch:{isNew(){this.innIsNew=this.isNew},couponItem(){this.innCoupon=JSON.parse(JSON.stringify(this.couponItem))}},methods:{showModal(){this.myModal.show(),console.log(this.innCoupon)},hideModal(){this.myModal.hide()},updateCoupon(n){this.$emit("updateCoupon",n)}},mounted(){this.myModal=new k(this.$refs.couponModal),this.innIsNew=this.isNew,this.innCoupon=JSON.parse(JSON.stringify(this.couponItem))}},N={class:"modal fade",ref:"couponModal","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},$={class:"modal-dialog modal-xl"},x={class:"modal-content"},V={class:"modal-header"},D={key:0,class:"modal-title"},U={key:1,class:"modal-title"},I=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),B={class:"modal-body"},P={class:"mb-3"},L=e("label",{for:"title",class:"form-label"},"\u6D3B\u52D5\u540D\u7A31",-1),O={class:"mb-3"},S=e("label",{for:"percent",class:"form-label"},"\u6298\u6263",-1),E={class:"mb-3"},J=e("label",{for:"due_date",class:"form-label"},"\u6709\u6548\u671F\u9650",-1),A={class:"mb-3"},F=e("label",{for:"code",class:"form-label"},"\u6298\u6263\u78BC",-1),T=["checked"],j={key:0,class:"form-check-label",for:"is_enabled"},Y={key:1,class:"form-check-label",for:"is_enabled"},q={class:"modal-footer"},z=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1);function G(n,t,a,u,o,c){return l(),d("div",N,[e("div",$,[e("div",x,[e("div",V,[o.innIsNew?(l(),d("h5",D,"\u65B0\u589E\u6298\u6263\u78BC")):(l(),d("h5",U,p(o.innCoupon.title),1)),I]),e("div",B,[e("div",P,[L,r(e("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":t[0]||(t[0]=i=>o.innCoupon.title=i),placeholder:"\u8F38\u5165\u6D3B\u52D5"},null,512),[[h,o.innCoupon.title]])]),e("div",O,[S,r(e("input",{type:"number",class:"form-control",id:"percent","onUpdate:modelValue":t[1]||(t[1]=i=>o.innCoupon.percent=i),placeholder:"\u8F38\u5165\u6298\u6263"},null,512),[[h,o.innCoupon.percent]])]),e("div",E,[J,r(e("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":t[2]||(t[2]=i=>o.innCoupon.due_date=i),placeholder:"\u8F38\u5165\u6709\u6548\u671F\u9650"},null,512),[[h,o.innCoupon.due_date]])]),e("div",A,[F,r(e("input",{type:"text",class:"form-control",id:"code","onUpdate:modelValue":t[3]||(t[3]=i=>o.innCoupon.code=i),placeholder:"\u8F38\u5165\u6298\u6263\u78BC"},null,512),[[h,o.innCoupon.code]])]),e("div",null,[e("div",{class:"form-check form-switch",onClick:t[4]||(t[4]=i=>o.innCoupon.is_enabled?o.innCoupon.is_enabled=0:o.innCoupon.is_enabled=1)},[e("input",{class:"form-check-input",type:"checkbox",role:"switch",id:"is_enabled",checked:o.innCoupon.is_enabled===1},null,8,T),o.innCoupon.is_enabled===1?(l(),d("label",j,"\u986F\u793A")):(l(),d("label",Y,"\u96B1\u85CF"))])])]),e("div",q,[z,e("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=i=>c.updateCoupon(o.innCoupon))},"\u5132\u5B58")])])])],512)}const H=f(g,[["render",G]]),K={data(){return{VUE_APP:"https://vue3-course-api.hexschool.io/v2/api/groen",isLoading:!1,isNew:!1,coupons:[],coupon:{title:"",is_enabled:1,percent:80,due_date:1555459200,code:"leftyprint2022"}}},components:{couponModal:H},methods:{getCoupons(){this.$http.get(`${this.VUE_APP}/admin/coupons`).then(n=>{this.coupons=n.data.coupons}).catch(n=>{alert(n.response.data.message)})},updateCoupon(n){n.due_date=new Date(n.due_date).getTime();const t={...n};let a=`${this.VUE_APP}/admin/coupon`,u="post";this.isNew||(u="put",a=`${a}/${n.id}`),this.$http[u](a,{data:t}).then(o=>{this.hideModal(),this.getCoupons()}).catch(o=>{console.log(o)})},parseDate(n){const t=new Date(n).getFullYear(),a=new Date(n).getMonth()+1,u=new Date(n).getDate();return`${t}-${a}-${u}`},openModal(n,t){n==="new"?(this.coupon={is_enabled:1},this.$refs.callModal.showModal(),this.isNew=!0):n==="edit"?(t.due_date=this.parseDate(t.due_date),this.coupon={...t},this.$refs.callModal.showModal(),this.isNew=!1):n==="delete"&&(this.coupon={...t},this.$refs.callDelModal.showModal())},hideModal(){this.$refs.callModal.hideModal()}},mounted(){this.getCoupons()}},Q={key:1,class:"container"},R={class:"text-end"},W={class:"table"},X=e("thead",null,[e("th",null,"\u6D3B\u52D5\u540D\u7A31"),e("th",null,"\u6298\u6263"),e("th",null,"\u6709\u6548\u671F\u9650"),e("th",null,"\u6298\u6263\u78BC"),e("th",null,"\u986F\u793A")],-1),Z=["onClick"],ee=["checked"],oe={key:0,class:"form-check-label",for:"is_enabled"},te={key:1,class:"form-check-label",for:"is_enabled"},ne={class:"text-end"},se=["onClick"],le=["onClick"];function ie(n,t,a,u,o,c){const i=b("v-loading"),C=b("couponModal");return l(),d(m,null,[o.isLoading?(l(),y(i,{key:0,active:o.isLoading},null,8,["active"])):(l(),d("div",Q,[e("div",R,[e("button",{type:"button",class:"btn btn-dark",onClick:t[0]||(t[0]=s=>c.openModal("new"))}," \u65B0\u589E ")]),e("table",W,[X,e("tbody",null,[(l(!0),d(m,null,w(o.coupons,s=>(l(),d("tr",{key:s.id},[e("td",null,p(s.title),1),e("td",null,p(s.percent),1),e("td",null,p(c.parseDate(s.due_date)),1),e("td",null,p(s.code),1),e("td",null,[e("div",{class:"form-check form-switch",onClick:_=>{s.is_enabled?s.is_enabled=0:s.is_enabled=1,n.updateProduct(s)}},[e("input",{class:"form-check-input",type:"checkbox",role:"switch",id:"is_enabled",checked:s.is_enabled===1},null,8,ee),s.is_enabled===1?(l(),d("label",oe,"\u986F\u793A")):(l(),d("label",te,"\u96B1\u85CF"))],8,Z)]),e("td",ne,[e("button",{type:"button",class:"btn btn-sm btn-outline-dark",onClick:_=>c.openModal("edit",s)}," \u7DE8\u8F2F",8,se),v("\xA0 "),e("button",{type:"button",class:"btn btn-sm btn-outline-danger",onClick:_=>c.openModal("delete",s)}," \u522A\u9664 ",8,le)])]))),128))])])])),M(C,{"is-new":o.isNew,"coupon-item":o.coupon,onUpdateCoupon:c.updateCoupon,ref:"callModal"},null,8,["is-new","coupon-item","onUpdateCoupon"])],64)}const pe=f(K,[["render",ie]]);export{pe as default};
