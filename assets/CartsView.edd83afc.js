import{e as l}from"./emitter.2ccbb68b.js";import{S as v}from"./SweetAlert.7fd22199.js";import{_ as w,r as f,o as h,a as _,d as m,b as s,F as g,u as x,t as d,e as p,w as y,n as $,y as C}from"./index.3993671e.js";import{_ as k}from"./people01.1d41a424.js";const L={data(){return{VUE_APP:"https://vue3-course-api.hexschool.io/v2/api/groen",isLoading:!1,total:0,final_total:0,carts:[],order:{user:{name:"",email:"",tel:"",address:""},message:""}}},components:{SweetAlert:v},methods:{getCarts(){this.isLoading=!0;const n=`${this.VUE_APP}/cart`;this.$http.get(n).then(t=>{console.log(t.data.data),this.isLoading=!1,this.total=t.data.data.total,this.final_total=t.data.data.final_total;const u=t.data.data.carts,r=[];u.forEach(e=>{if(e.files===void 0||e.files.length<=1)r.push(e);else{const c=e.files.length;for(let i=0;i<c;i++){const o={...e};o.files=[e.files[i]],o.files[0].id=i+1,r.push(o)}}}),this.carts=r,l.emit("cartCount")}).catch(t=>{this.isLoading=!1,l.emit("sweetalert",`${t.response.data.message}, error`)})},clearCarts(){this.isLoading=!0;const n=`${this.VUE_APP}/carts`;this.$http.delete(n).then(t=>{this.isLoading=!1,l.emit("sweetalert",`${t.data.message}, success`),this.getCarts()}).catch(t=>{this.isLoading=!1,l.emit("sweetalert",`${t.response.data.message}, error`)})},delCart(n,t){this.isLoading=!0;const u=`${this.VUE_APP}/cart`;this.$http.get(u).then(r=>{const c=r.data.data.carts.find(i=>i.product_id===n.product_id);if(c.files===void 0||c.files.length<=1){const i=`https://vue3-course-api.hexschool.io/v2/api/groen/cart/${n.id}`;this.$http.delete(i).then(o=>{this.isLoading=!1,l.emit("sweetalert",`${o.data.message}, success`),this.getCarts()}).catch(o=>{this.isLoading=!1,l.emit("sweetalert",`${o.response.data.message}, error`)})}else{c.files.splice(t-1,1);const i=`https://vue3-course-api.hexschool.io/v2/api/groen/cart/${n.id}`;this.$http.put(i,{data:{product_id:c.id,qty:1,files:c.files}}).then(o=>{this.isLoading=!1,l.emit("sweetalert",`${o.data.message}, success`),this.getCarts()}).catch(o=>{this.isLoading=!1,l.emit("sweetalert",`${o.response.data.message}, error`)})}}).catch(r=>{this.isLoading=!1,l.emit("sweetalert",`${r.response.data.message}, error`)})},onSubmit(){this.isLoading=!0;const n=`${this.VUE_APP}/order`;this.$http.post(n,{data:{...this.order}}).then(t=>{this.isLoading=!1,l.emit("sweetalert",`${t.data.message}, success`),this.getCarts(),this.$refs.form.resetForm()}).catch(t=>{this.isLoading=!1,l.emit("sweetalert",`${t.response.data.message}, error`)})}},mounted(){this.getCarts()}},P={class:"container mt-5 mb-8"},V=s("div",{class:"mb-3 d-flex align-items-end"},[s("img",{class:"me-3 headtitle-img",src:k,alt:""}),s("div",null,[s("span",{class:"d-inline-block mb-3 px-4 py-2 text-white lh-1 bg-primary rounded-pill position-relative dialog"},"Cart"),s("h2",{class:"mb-0 fw-bolder"},"\u8CFC\u7269\u8ECA")])],-1),A={class:"row g-4"},E={class:"col-lg-8 col-12"},S={class:"mb-3"},U={class:"px-3 py-2 bg-gray100 fw-bold d-flex justify-content-between"},B=s("span",null,"\u9805\u76EE",-1),F=["disabled"],N={key:0,class:"p-4 text-secondary"},j={key:1},q={class:"row g-5"},I={class:"col-6"},M={key:0},z={key:1,class:"d-flex"},D=["src"],T=["src"],X={class:"col-auto d-flex align-items-center"},G={class:"me-5"},H={class:"fw-bold mb-2"},J=s("br",null,null,-1),K={class:"text-secondary fs-7"},O=s("br",null,null,-1),Q={class:"text-secondary fs-7"},R=s("span",{class:"me-3 small"},"\u6750\u8CEA",-1),W=s("br",null,null,-1),Y=s("span",{class:"me-3 small"},"\u6578\u91CF",-1),Z={class:"text-end align-self-end"},ss={class:"text-nowrap mb-3 fw-bolder"},ts=["onClick"],es=s("span",{class:"material-symbols-outlined fs-5"},"delete",-1),as=[es],os={class:"col-lg col-12"},is={class:"p-4 bg-light sticky-top"},ls=s("div",{class:"mb-4 fs-5 text-primary"}," \u8A02\u55AE\u6458\u8981 ",-1),ns={class:"mb-3 border-bottom border-white"},cs={class:"mb-3 d-flex"},ds=s("span",{class:"me-auto text-secondary"},"\u5C0F\u8A08",-1),rs={class:"fw-bolder"},hs=s("div",{class:"mb-3 d-flex"},[s("span",{class:"me-auto text-secondary"},"\u904B\u8CBB"),s("span",null,"\u514D\u904B\u8CBB")],-1),_s={class:"mb-3 d-flex"},ps=s("span",{class:"me-auto text-secondary"},"\u7E3D\u8A08",-1),us={class:"fw-bolder text-accent"},fs={class:"fs-5"},ms={class:"text-end"};function gs(n,t,u,r,e,c){const i=f("v-loading"),o=f("SweetAlert"),b=f("router-link");return h(),_(g,null,[m(i,{active:e.isLoading},null,8,["active"]),m(o),s("div",P,[V,s("div",A,[s("div",E,[s("div",S,[s("div",U,[B,s("button",{class:"btn btn-sm btn-outline-secondary",onClick:t[0]||(t[0]=a=>c.clearCarts()),disabled:e.carts.length<=0},"\u6E05\u9664\u8CFC\u7269\u8ECA",8,F)]),s("div",null,[e.carts.length<=0?(h(),_("p",N,"\u8CFC\u7269\u8ECA\u5C1A\u7121\u5167\u5BB9")):(h(),_("div",j,[(h(!0),_(g,null,x(e.carts,a=>(h(),_("div",{key:a.id,class:"py-4 pe-3 d-flex justify-content-between align-items-center border-bottom"},[s("div",q,[s("div",I,[a.files===void 0?(h(),_("div",M," \xA0 ")):(h(),_("div",z,[s("img",{src:a.files[0].front,class:"d-inline-block border img-fluid me-1",style:{width:"50%"},alt:""},null,8,D),s("img",{src:a.files[0].back,class:"d-inline-block border img-fluid",style:{width:"50%"},alt:""},null,8,T)]))]),s("div",X,[s("div",G,[s("span",H,d(a.product.title),1),J,s("span",K,[p(d(a.product.width)+" mm X "+d(a.product.height)+" mm ",1),O,p(" "+d(a.product.side),1)])]),s("div",Q,[s("span",null,[R,p(d(a.product.material),1)]),W,s("span",null,[Y,p(d(a.product.p_qty)+" "+d(a.product.unit),1)])])])]),s("div",Z,[s("div",ss,"$ "+d(a.product.price),1),s("a",{href:"#",class:"btn-link",onClick:C(bs=>c.delCart(a,a.files[0].id),["prevent"])},as,8,ts)])]))),128))]))])])]),s("div",os,[s("div",is,[ls,s("div",ns,[s("div",cs,[ds,s("span",rs,"$ "+d(e.total),1)]),hs]),s("div",_s,[ps,s("span",us,[p("$ "),s("span",fs,d(Math.round(e.final_total)),1)])]),s("div",ms,[m(b,{to:"/carts2",class:$(["btn btn-accent",{disabled:e.carts.length<=0}])},{default:y(()=>[p("\u4E0B\u4E00\u6B65")]),_:1},8,["class"])])])])])])],64)}const $s=w(L,[["render",gs]]);export{$s as default};
