import{e as l}from"./emitter.2ccbb68b.js";import{S as v}from"./SweetAlert.8f8cff93.js";import{_ as w,r as f,o as h,b as _,e as g,d as s,F as m,v as x,t as d,f as p,w as y,n as $,A as C}from"./index.e4510dc4.js";import{_ as k}from"./people01.1d41a424.js";const L={data(){return{VUE_APP:"https://vue3-course-api.hexschool.io/v2/api/groen",isLoading:!1,total:0,final_total:0,carts:[],order:{user:{name:"",email:"",tel:"",address:""},message:""}}},components:{SweetAlert:v},methods:{getCarts(){this.isLoading=!0;const n=`${this.VUE_APP}/cart`;this.$http.get(n).then(t=>{console.log(t.data.data),this.isLoading=!1,this.total=t.data.data.total,this.final_total=t.data.data.final_total;const u=t.data.data.carts,r=[];u.forEach(a=>{if(a.files===void 0||a.files.length<=1)r.push(a);else{const c=a.files.length;for(let i=0;i<c;i++){const o={...a};o.files=[a.files[i]],o.files[0].id=i+1,r.push(o)}}}),this.carts=r,console.log(this.carts[2].files[0].back),l.emit("cartCount")}).catch(t=>{this.isLoading=!1,l.emit("sweetalert",`${t.response.data.message}, error`)})},clearCarts(){this.isLoading=!0;const n=`${this.VUE_APP}/carts`;this.$http.delete(n).then(t=>{this.isLoading=!1,l.emit("sweetalert",`${t.data.message}, success`),this.getCarts()}).catch(t=>{this.isLoading=!1,l.emit("sweetalert",`${t.response.data.message}, error`)})},delCart(n,t){this.isLoading=!0;const u=`${this.VUE_APP}/cart`;this.$http.get(u).then(r=>{const c=r.data.data.carts.find(i=>i.product_id===n.product_id);if(c.files===void 0||c.files.length<=1){const i=`https://vue3-course-api.hexschool.io/v2/api/groen/cart/${n.id}`;this.$http.delete(i).then(o=>{this.isLoading=!1,l.emit("sweetalert",`${o.data.message}, success`),this.getCarts()}).catch(o=>{this.isLoading=!1,l.emit("sweetalert",`${o.response.data.message}, error`)})}else{c.files.splice(t-1,1);const i=`https://vue3-course-api.hexschool.io/v2/api/groen/cart/${n.id}`;this.$http.put(i,{data:{product_id:c.id,qty:1,files:c.files}}).then(o=>{this.isLoading=!1,l.emit("sweetalert",`${o.data.message}, success`),this.getCarts()}).catch(o=>{this.isLoading=!1,l.emit("sweetalert",`${o.response.data.message}, error`)})}}).catch(r=>{this.isLoading=!1,l.emit("sweetalert",`${r.response.data.message}, error`)})},onSubmit(){this.isLoading=!0;const n=`${this.VUE_APP}/order`;this.$http.post(n,{data:{...this.order}}).then(t=>{this.isLoading=!1,l.emit("sweetalert",`${t.data.message}, success`),this.getCarts(),this.$refs.form.resetForm()}).catch(t=>{this.isLoading=!1,l.emit("sweetalert",`${t.response.data.message}, error`)})}},mounted(){this.getCarts()}},P={class:"container mt-5 mb-8"},V=s("div",null,[s("div",{class:"mb-3 d-flex align-items-end"},[s("img",{class:"me-3 headtitle-img",src:k,alt:""}),s("div",null,[s("span",{class:"d-inline-block mb-3 px-4 py-2 text-white lh-1 bg-primary rounded-pill position-relative dialog"},"Cart"),s("h2",{class:"mb-0 fw-bolder"},"\u8CFC\u7269\u8ECA")])])],-1),A={class:"row g-4"},E={class:"col-lg-8 col-12"},S={class:"mb-3"},U={class:"px-3 py-2 bg-gray100 fw-bold d-flex justify-content-between"},B=s("span",null,"\u9805\u76EE",-1),F=["disabled"],N={key:0,class:"p-4 text-secondary"},j={key:1},q={class:"row g-5"},I={class:"col-6"},M={key:0},z=["src"],D={key:1,class:"d-flex"},T=["src"],G=["src"],H={class:"col-auto d-flex align-items-center"},J={class:"me-5"},K={class:"fw-bold mb-2"},O=s("br",null,null,-1),Q={class:"text-secondary fs-7"},R=s("br",null,null,-1),W={class:"text-secondary fs-7"},X=s("span",{class:"me-3 small"},"\u6750\u8CEA",-1),Y=s("br",null,null,-1),Z=s("span",{class:"me-3 small"},"\u6578\u91CF",-1),ss={class:"text-end align-self-end"},ts={class:"text-nowrap mb-3 fw-bolder"},es=["onClick"],as=s("span",{class:"material-symbols-outlined fs-5"},"delete",-1),os=[as],is={class:"col-lg col-12"},ls={class:"p-4 bg-light sticky-top"},ns=s("div",{class:"mb-4 fs-5 text-primary"}," \u8A02\u55AE\u6458\u8981 ",-1),cs={class:"mb-3 border-bottom border-white"},ds={class:"mb-3 d-flex"},rs=s("span",{class:"me-auto text-secondary"},"\u5C0F\u8A08",-1),hs={class:"fw-bolder"},_s=s("div",{class:"mb-3 d-flex"},[s("span",{class:"me-auto text-secondary"},"\u904B\u8CBB"),s("span",null,"\u514D\u904B\u8CBB")],-1),ps={class:"mb-3 d-flex"},us=s("span",{class:"me-auto text-secondary"},"\u7E3D\u8A08",-1),fs={class:"fw-bolder text-accent"},gs={class:"fs-5"},ms={class:"text-end"};function bs(n,t,u,r,a,c){const i=f("v-loading"),o=f("SweetAlert"),b=f("router-link");return h(),_(m,null,[g(i,{active:a.isLoading},null,8,["active"]),g(o),s("div",P,[V,s("div",A,[s("div",E,[s("div",S,[s("div",U,[B,s("button",{class:"btn btn-sm btn-outline-secondary",onClick:t[0]||(t[0]=e=>c.clearCarts()),disabled:a.carts.length<=0},"\u6E05\u9664\u8CFC\u7269\u8ECA",8,F)]),s("div",null,[a.carts.length<=0?(h(),_("p",N,"\u8CFC\u7269\u8ECA\u5C1A\u7121\u5167\u5BB9")):(h(),_("div",j,[(h(!0),_(m,null,x(a.carts,e=>(h(),_("div",{key:e.id,class:"py-4 pe-3 d-flex justify-content-between align-items-center border-bottom"},[s("div",q,[s("div",I,[e.files[0].back===void 0?(h(),_("div",M,[s("img",{src:e.files[0].front,class:"border img-fluid",alt:""},null,8,z)])):(h(),_("div",D,[s("img",{src:e.files[0].front,class:"border img-fluid me-1",style:{width:"48.5%"},alt:""},null,8,T),s("img",{src:e.files[0].back,class:"border img-fluid",style:{width:"48.5%"},alt:""},null,8,G)]))]),s("div",H,[s("div",J,[s("span",K,d(e.product.title),1),O,s("span",Q,[p(d(e.product.width)+" x "+d(e.product.height)+" mm ",1),R,p(" "+d(e.product.side),1)])]),s("div",W,[s("span",null,[X,p(d(e.product.material),1)]),Y,s("span",null,[Z,p(d(e.product.p_qty)+" "+d(e.product.unit),1)])])])]),s("div",ss,[s("div",ts,"$ "+d(e.product.price),1),s("a",{href:"#",class:"btn-link",onClick:C(vs=>c.delCart(e,e.files[0].id),["prevent"])},os,8,es)])]))),128))]))])])]),s("div",is,[s("div",ls,[ns,s("div",cs,[s("div",ds,[rs,s("span",hs,"$ "+d(a.total),1)]),_s]),s("div",ps,[us,s("span",fs,[p("$ "),s("span",gs,d(Math.round(a.final_total)),1)])]),s("div",ms,[g(b,{to:"/carts2",class:$(["btn btn-accent",{disabled:a.carts.length<=0}])},{default:y(()=>[p("\u4E0B\u4E00\u6B65")]),_:1},8,["class"])])])])])])],64)}const Cs=w(L,[["render",bs]]);export{Cs as default};
