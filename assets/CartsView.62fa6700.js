import{e as n}from"./emitter.2ccbb68b.js";import{S as w}from"./SweetAlert.4a9c0aac.js";import{H as x}from"./HeadTitle.eb04b7b0.js";import{_ as $,r as f,o as h,b as _,e as m,d as s,F as g,v as y,t as d,f as p,w as C,n as L,A as k}from"./index.76ecbe00.js";import"./people01.1d41a424.js";const P={data(){return{VUE_APP:"https://vue3-course-api.hexschool.io/v2/api/groen",isLoading:!1,total:0,final_total:0,carts:[],order:{user:{name:"",email:"",tel:"",address:""},message:""}}},components:{SweetAlert:w,HeadTitle:x},methods:{getCarts(){this.isLoading=!0;const l=`${this.VUE_APP}/cart`;this.$http.get(l).then(t=>{this.isLoading=!1,this.total=t.data.data.total,this.final_total=t.data.data.final_total;const u=t.data.data.carts,r=[];u.forEach(a=>{if(a.files===void 0||a.files.length<=1)r.push(a);else{const c=a.files.length;for(let i=0;i<c;i++){const o={...a};o.files=[a.files[i]],o.files[0].id=i+1,r.push(o)}}}),this.carts=r,n.emit("cartCount")}).catch(t=>{this.isLoading=!1,n.emit("sweetalert",`${t.response.data.message}, error`)})},clearCarts(){this.isLoading=!0;const l=`${this.VUE_APP}/carts`;this.$http.delete(l).then(t=>{this.isLoading=!1,n.emit("sweetalert",`${t.data.message}, success`),this.getCarts()}).catch(t=>{this.isLoading=!1,n.emit("sweetalert",`${t.response.data.message}, error`)})},delCart(l,t){this.isLoading=!0;const u=`${this.VUE_APP}/cart`;this.$http.get(u).then(r=>{const c=r.data.data.carts.find(i=>i.product_id===l.product_id);if(c.files===void 0||c.files.length<=1){const i=`https://vue3-course-api.hexschool.io/v2/api/groen/cart/${l.id}`;this.$http.delete(i).then(o=>{this.isLoading=!1,n.emit("sweetalert",`${o.data.message}, success`),this.getCarts()}).catch(o=>{this.isLoading=!1,n.emit("sweetalert",`${o.response.data.message}, error`)})}else{c.files.splice(t-1,1);const i=`https://vue3-course-api.hexschool.io/v2/api/groen/cart/${l.id}`;this.$http.put(i,{data:{product_id:c.id,qty:1,files:c.files}}).then(o=>{this.isLoading=!1,n.emit("sweetalert",`${o.data.message}, success`),this.getCarts()}).catch(o=>{this.isLoading=!1,n.emit("sweetalert",`${o.response.data.message}, error`)})}}).catch(r=>{this.isLoading=!1,n.emit("sweetalert",`${r.response.data.message}, error`)})},onSubmit(){this.isLoading=!0;const l=`${this.VUE_APP}/order`;this.$http.post(l,{data:{...this.order}}).then(t=>{this.isLoading=!1,n.emit("sweetalert",`${t.data.message}, success`),this.getCarts(),this.$refs.form.resetForm()}).catch(t=>{this.isLoading=!1,n.emit("sweetalert",`${t.response.data.message}, error`)})}},mounted(){this.getCarts()}},A={class:"container pt-5 pb-8"},V={class:"mb-3"},E={class:"container"},S={class:"row g-4"},U={class:"col-lg-8 col-12"},H={class:"mb-3"},T={class:"px-3 py-2 bg-gray100 fw-bold d-flex justify-content-between"},B=s("span",null,"\u9805\u76EE",-1),F=["disabled"],N={key:0,class:"p-4 text-secondary"},j={key:1},q={class:"row g-5"},I={class:"col-sm-6"},M={key:0},z=["src"],D={key:1,class:"d-flex"},G=["src"],J=["src"],K={class:"col-sm-auto d-flex align-items-center"},O={class:"me-5 ps-2 ps-sm-0"},Q={class:"fw-bold mb-2"},R=s("br",null,null,-1),W={class:"text-secondary fs-7"},X=s("br",null,null,-1),Y={class:"text-secondary fs-7"},Z=s("span",{class:"me-3 small"},"\u6750\u8CEA",-1),ss=s("br",null,null,-1),ts=s("span",{class:"me-3 small"},"\u6578\u91CF",-1),es={class:"text-end align-self-end"},as={class:"text-nowrap mb-3 fw-bolder"},os=["onClick"],is=s("span",{class:"material-symbols-outlined fs-5"},"delete",-1),ns=[is],ls={class:"col-lg col-12"},cs={class:"p-4 bg-light sticky-top"},ds=s("div",{class:"mb-4 fs-5 text-primary"}," \u8A02\u55AE\u6458\u8981 ",-1),rs={class:"mb-3 border-bottom border-white"},hs={class:"mb-3 d-flex"},_s=s("span",{class:"me-auto text-secondary"},"\u5C0F\u8A08",-1),ps={class:"fw-bolder"},us=s("div",{class:"mb-3 d-flex"},[s("span",{class:"me-auto text-secondary"},"\u904B\u8CBB"),s("span",null,"\u514D\u904B\u8CBB")],-1),fs={class:"mb-3 d-flex"},ms=s("span",{class:"me-auto text-secondary"},"\u7E3D\u8A08",-1),gs={class:"fw-bolder text-accent"},bs={class:"fs-5"},vs={class:"text-end"};function ws(l,t,u,r,a,c){const i=f("v-loading"),o=f("SweetAlert"),b=f("HeadTitle"),v=f("router-link");return h(),_(g,null,[m(i,{active:a.isLoading},null,8,["active"]),m(o),s("div",A,[s("div",V,[s("div",E,[m(b,{dialog:"Cart","dark-text":"\u8CFC\u7269\u8ECA"})])]),s("div",S,[s("div",U,[s("div",H,[s("div",T,[B,s("button",{class:"btn btn-sm btn-outline-secondary",onClick:t[0]||(t[0]=e=>c.clearCarts()),disabled:a.carts.length<=0},"\u6E05\u9664\u8CFC\u7269\u8ECA",8,F)]),s("div",null,[a.carts.length<=0?(h(),_("p",N,"\u8CFC\u7269\u8ECA\u5C1A\u7121\u5167\u5BB9")):(h(),_("div",j,[(h(!0),_(g,null,y(a.carts,e=>(h(),_("div",{key:e.id,class:"py-4 pe-3 d-flex justify-content-between align-items-center border-bottom"},[s("div",q,[s("div",I,[e.files[0].back===void 0?(h(),_("div",M,[s("img",{src:e.files[0].front,class:"border img-fluid",style:{width:"400px"},alt:""},null,8,z)])):(h(),_("div",D,[s("img",{src:e.files[0].front,class:"border img-fluid me-1",style:{width:"48.5%","max-width":"200px"},alt:""},null,8,G),s("img",{src:e.files[0].back,class:"border img-fluid",style:{width:"48.5%","max-width":"200px"},alt:""},null,8,J)]))]),s("div",K,[s("div",O,[s("span",Q,d(e.product.title),1),R,s("span",W,[p(d(e.product.width)+" x "+d(e.product.height)+" mm ",1),X,p(" "+d(e.product.side),1)])]),s("div",Y,[s("span",null,[Z,p(d(e.product.material),1)]),ss,s("span",null,[ts,p(d(e.product.p_qty)+" "+d(e.product.unit),1)])])])]),s("div",es,[s("div",as,"$ "+d(e.product.price),1),s("a",{href:"#",class:"btn-link",onClick:k(xs=>c.delCart(e,e.files[0].id),["prevent"])},ns,8,os)])]))),128))]))])])]),s("div",ls,[s("div",cs,[ds,s("div",rs,[s("div",hs,[_s,s("span",ps,"$ "+d(a.total),1)]),us]),s("div",fs,[ms,s("span",gs,[p("$ "),s("span",bs,d(Math.round(a.final_total)),1)])]),s("div",vs,[m(v,{to:"/carts2",class:L(["btn btn-accent",{disabled:a.carts.length<=0}])},{default:C(()=>[p("\u4E0B\u4E00\u6B65")]),_:1},8,["class"])])])])])])],64)}const Ps=$(P,[["render",ws]]);export{Ps as default};
