import{e as n}from"./emitter.2ccbb68b.js";import{S as v}from"./SweetAlert.f5e4cf8d.js";import{_ as x,r as f,o as h,a as _,d as g,b as s,F as m,u as w,t as d,e as p,w as $,y}from"./index.a95f69e0.js";import{_ as C}from"./people01.1d41a424.js";const L={data(){return{VUE_APP:"https://vue3-course-api.hexschool.io/v2/api/groen",isLoading:!1,total:0,final_total:0,carts:[],order:{user:{name:"",email:"",tel:"",address:""},message:""}}},components:{SweetAlert:v},methods:{getCarts(){this.isLoading=!0;const l=`${this.VUE_APP}/cart`;this.$http.get(l).then(t=>{console.log(t.data.data),this.isLoading=!1,this.total=t.data.data.total,this.final_total=t.data.data.final_total;const u=t.data.data.carts,r=[];u.forEach(a=>{if(a.files===void 0||a.files.length<=1)r.push(a);else{const c=a.files.length;for(let i=0;i<c;i++){const o={...a};o.files=[a.files[i]],o.files[0].id=i+1,r.push(o)}}}),this.carts=r,n.emit("cartCount")}).catch(t=>{this.isLoading=!1,n.emit("sweetalert",`${t.response.data.message}, error`)})},clearCarts(){this.isLoading=!0;const l=`${this.VUE_APP}/carts`;this.$http.delete(l).then(t=>{this.isLoading=!1,n.emit("sweetalert",`${t.data.message}, success`),this.getCarts()}).catch(t=>{this.isLoading=!1,n.emit("sweetalert",`${t.response.data.message}, error`)})},delCart(l,t){this.isLoading=!0;const u=`${this.VUE_APP}/cart`;this.$http.get(u).then(r=>{const c=r.data.data.carts.find(i=>i.product_id===l.product_id);if(c.files===void 0||c.files.length<=1){const i=`https://vue3-course-api.hexschool.io/v2/api/groen/cart/${l.id}`;this.$http.delete(i).then(o=>{this.isLoading=!1,n.emit("sweetalert",`${o.data.message}, success`),this.getCarts()}).catch(o=>{this.isLoading=!1,n.emit("sweetalert",`${o.response.data.message}, error`)})}else{c.files.splice(t-1,1);const i=`https://vue3-course-api.hexschool.io/v2/api/groen/cart/${l.id}`;this.$http.put(i,{data:{product_id:c.id,qty:1,files:c.files}}).then(o=>{this.isLoading=!1,n.emit("sweetalert",`${o.data.message}, success`),this.getCarts()}).catch(o=>{this.isLoading=!1,n.emit("sweetalert",`${o.response.data.message}, error`)})}}).catch(r=>{this.isLoading=!1,n.emit("sweetalert",`${r.response.data.message}, error`)})},onSubmit(){this.isLoading=!0;const l=`${this.VUE_APP}/order`;this.$http.post(l,{data:{...this.order}}).then(t=>{this.isLoading=!1,n.emit("sweetalert",`${t.data.message}, success`),this.getCarts(),this.$refs.form.resetForm()}).catch(t=>{this.isLoading=!1,n.emit("sweetalert",`${t.response.data.message}, error`)})}},mounted(){this.getCarts()}},k={class:"container mt-5"},P=s("div",{class:"mb-3 d-flex align-items-end"},[s("img",{class:"me-3 headtitle-img",src:C,alt:""}),s("div",null,[s("span",{class:"d-inline-block mb-3 px-4 py-2 text-white lh-1 bg-primary rounded-pill position-relative dialog"},"Cart"),s("h2",{class:"mb-0 fw-bolder"},"\u8CFC\u7269\u8ECA")])],-1),V={class:"row g-4"},A={class:"col-lg-8 col-12"},E={class:"mb-3"},S={class:"px-3 py-2 bg-gray100 fw-bold d-flex justify-content-between"},U=s("span",null,"\u9805\u76EE",-1),B=["disabled"],F={key:0,class:"p-4 text-secondary"},N={key:1},j={class:"d-xl-flex align-items-center"},q={class:"mb-xl-0 mb-4 me-6"},I={key:0,style:{height:"100px"}},M={key:1},D=["src"],T=["src"],X={class:"me-6"},z={class:"fw-bold mb-2"},G=s("br",null,null,-1),H={class:"text-secondary fs-7"},J=s("br",null,null,-1),K={class:"text-secondary fs-7"},O=s("span",{class:"me-3"},"\u6750\u8CEA",-1),Q=s("br",null,null,-1),R=s("span",{class:"me-3"},"\u6578\u91CF",-1),W={class:"text-end align-self-end"},Y={class:"text-nowrap mb-3 fw-bolder"},Z=["onClick"],ss=s("span",{class:"material-symbols-outlined fs-5"},"delete",-1),ts=[ss],es={class:"col-lg col-12"},as={class:"p-4 bg-light sticky-top"},os=s("div",{class:"mb-4 fs-5 text-primary"}," \u8A02\u55AE\u6458\u8981 ",-1),is={class:"mb-3 border-bottom border-white"},ns={class:"mb-3 d-flex"},ls=s("span",{class:"me-auto text-secondary"},"\u5C0F\u8A08",-1),cs={class:"fw-bolder"},ds=s("div",{class:"mb-3 d-flex"},[s("span",{class:"me-auto text-secondary"},"\u904B\u8CBB"),s("span",null,"\u514D\u904B\u8CBB")],-1),rs={class:"mb-3 d-flex"},hs=s("span",{class:"me-auto text-secondary"},"\u7E3D\u8A08",-1),_s={class:"fw-bolder text-accent"},ps={class:"fs-5"},us={class:"text-end"};function fs(l,t,u,r,a,c){const i=f("v-loading"),o=f("SweetAlert"),b=f("router-link");return h(),_(m,null,[g(i,{active:a.isLoading},null,8,["active"]),g(o),s("div",k,[P,s("div",V,[s("div",A,[s("div",E,[s("div",S,[U,s("button",{class:"btn btn-sm btn-outline-secondary",onClick:t[0]||(t[0]=e=>c.clearCarts()),disabled:a.carts.length<=0},"\u6E05\u9664\u8CFC\u7269\u8ECA",8,B)]),s("div",null,[a.carts.length<=0?(h(),_("p",F,"\u8CFC\u7269\u8ECA\u5C1A\u7121\u5167\u5BB9")):(h(),_("div",N,[(h(!0),_(m,null,w(a.carts,e=>(h(),_("div",{key:e.id,class:"py-4 pe-3 d-flex justify-content-between align-items-center border-bottom"},[s("div",j,[s("div",q,[e.files===void 0?(h(),_("div",I," \xA0 ")):(h(),_("div",M,[s("img",{src:e.files[0].front,class:"border",height:"100",alt:""},null,8,D),p("\xA0 "),s("img",{src:e.files[0].back,class:"border",height:"100",alt:""},null,8,T)]))]),s("div",X,[s("span",z,d(e.product.title),1),G,s("span",H,[p(d(e.product.width)+" mm X "+d(e.product.height)+" mm ",1),J,p(" "+d(e.product.side),1)])]),s("div",K,[s("span",null,[O,p(d(e.product.material),1)]),Q,s("span",null,[R,p(d(e.product.p_qty)+" "+d(e.product.unit),1)])])]),s("div",W,[s("div",Y,"$ "+d(e.product.price),1),s("a",{href:"#",class:"btn-link",onClick:y(gs=>c.delCart(e,e.files[0].id),["prevent"])},ts,8,Z)])]))),128))]))])])]),s("div",es,[s("div",as,[os,s("div",is,[s("div",ns,[ls,s("span",cs,"$ "+d(a.total),1)]),ds]),s("div",rs,[hs,s("span",_s,[p("$ "),s("span",ps,d(Math.round(a.final_total)),1)])]),s("div",us,[g(b,{to:"/carts2",class:"btn btn-accent"},{default:$(()=>[p("\u4E0B\u4E00\u6B65")]),_:1})])])])])])],64)}const ws=x(L,[["render",fs]]);export{ws as default};
