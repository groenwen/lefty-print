import{e as d}from"./emitter.2ccbb68b.js";import{S as k}from"./SweetAlert.d9c235c1.js";import{H as C}from"./HeadTitle.94720bc9.js";import{_ as P,r as h,o as p,b as f,e as a,d as s,w,F as y,v as U,t as n,f as v,n as x}from"./index.09b44046.js";import"./people01.1d41a424.js";const E={data(){return{VUE_APP:"https://vue3-course-api.hexschool.io/v2/api/groen",isLoading:!1,total:0,final_total:0,carts:[],order:{user:{name:"",email:"",tel:"",address:""},message:""}}},components:{SweetAlert:k,HeadTitle:C},methods:{getCarts(){this.isLoading=!0;const r=`${this.VUE_APP}/cart`;this.$http.get(r).then(e=>{this.isLoading=!1,this.total=e.data.data.total,this.final_total=e.data.data.final_total;const g=e.data.data.carts,_=[];g.forEach(t=>{if(t.files===void 0||t.files.length<=1)_.push(t);else{const c=t.files.length;for(let i=0;i<c;i++){const l={...t};l.files=[t.files[i]],l.files[0].id=i+1,_.push(l)}}}),this.carts=_,d.emit("cartCount")}).catch(e=>{this.isLoading=!1,d.emit("sweetalert",`${e.response.data.message}, error`)})},clearCarts(){this.isLoading=!0;const r=`${this.VUE_APP}/carts`;this.$http.delete(r).then(e=>{this.isLoading=!1,d.emit("sweetalert",`${e.data.message}, success`),this.getCarts()}).catch(e=>{this.isLoading=!1,d.emit("sweetalert",`${e.response.data.message}, error`)})},delCart(r,e){this.isLoading=!0;const g=`${this.VUE_APP}/cart`;this.$http.get(g).then(_=>{const c=_.data.data.carts.find(i=>i.product_id===r.product_id);if(c.files===void 0||c.files.length<=1){const i=`https://vue3-course-api.hexschool.io/v2/api/groen/cart/${r.id}`;this.$http.delete(i).then(l=>{this.isLoading=!1,d.emit("sweetalert",`${l.data.message}, success`),this.getCarts()}).catch(l=>{this.isLoading=!1,d.emit("sweetalert",`${l.response.data.message}, error`)})}else{c.files.splice(e-1,1);const i=`https://vue3-course-api.hexschool.io/v2/api/groen/cart/${r.id}`;this.$http.put(i,{data:{product_id:c.id,qty:1,files:c.files}}).then(l=>{this.isLoading=!1,d.emit("sweetalert",`${l.data.message}, success`),this.getCarts()}).catch(l=>{this.isLoading=!1,d.emit("sweetalert",`${l.response.data.message}, error`)})}}).catch(_=>{this.isLoading=!1,d.emit("sweetalert",`${_.response.data.message}, error`)})},onSubmit(){this.isLoading=!0;const r=`${this.VUE_APP}/order`;this.$http.post(r,{data:{...this.order}}).then(e=>{this.isLoading=!1,d.emit("sweetalert",`${e.data.message}, success`),this.$router.push(`/OrderCheckout/${e.data.orderId}`)}).catch(e=>{this.isLoading=!1,d.emit("sweetalert",`${e.response.data.message}, error`)})}},mounted(){this.getCarts()}},S={class:"container pt-5 pb-8"},A={class:"row mb-3"},q={class:"col-md-8 d-flex justify-content-between align-items-end"},H=s("span",{class:"material-symbols-outlined align-text-bottom"},"arrow_back",-1),T={class:"row g-lg-5"},j={class:"order-2 order-md-1 col-md-8"},B={class:"bg-gray200 pt-6 pb-5"},F={class:"row justify-content-center"},I={class:"col-xl-9 col-lg-8 col-10"},N=s("h4",{class:"fw-bolder text-primary"}," \u6536\u4EF6\u4EBA ",-1),z={class:"mb-2 mb-sm-4"},D=s("label",{for:"name",class:"form-label fs-7"},"\u59D3\u540D",-1),M={class:"mb-2 mb-sm-4"},O=s("label",{for:"email",class:"form-label fs-7"},"Email",-1),G={class:"mb-2 mb-sm-4"},J=s("label",{for:"tel",class:"form-label fs-7"},"\u96FB\u8A71",-1),K={class:"mb-2 mb-sm-4"},Q=s("label",{for:"address",class:"form-label fs-7"},"\u5730\u5740",-1),R={class:"mb-4 mb-sm-5"},W=s("label",{for:"message",class:"form-label fs-7"},"\u8A02\u55AE\u5099\u8A3B",-1),X=s("div",{class:"d-grid col-md-7 mx-auto mb-5"},[s("button",{type:"submit",class:"btn btn-accent"},"\u7D50\u5E33")],-1),Y={class:"order-1 order-md-2 col-md-4"},Z={class:"mb-5 bg-gray-100"},ss=s("div",{class:"px-3 py-2 bg-gray100"},[s("span",{class:"text-secondary small"},"\u9805\u76EE")],-1),es={class:"mb-3"},ts={key:0},os=["src"],as={key:1,class:"d-flex"},ls=["src"],is=["src"],ds={class:"px-2 d-flex justify-content-between align-items-center"},rs={class:""},ns={class:"fw-bold mb-2"},cs=s("br",null,null,-1),ms={class:"text-secondary fs-7"},_s=s("br",null,null,-1),hs={class:"text-secondary fs-7"},us=s("br",null,null,-1),ps={class:"text-nowrap fw-bold"},fs={class:"mb-5"},gs=s("div",{class:"mb-3 px-3 py-2 bg-gray100"},[s("span",{class:"text-secondary small"},"\u8A02\u55AE\u6458\u8981")],-1),bs={class:"px-3"},vs={class:"mb-2 d-flex"},xs=s("span",{class:"me-auto text-secondary small"},"\u5C0F\u8A08",-1),ws={class:"fw-bold"},ys=s("div",{class:"mb-2 d-flex"},[s("span",{class:"me-auto text-secondary small"},"\u904B\u8CBB"),s("span",null,"\u514D\u904B\u8CBB")],-1),Vs={class:"px-3 d-flex"},$s=s("span",{class:"me-auto text-secondary small"},"\u7E3D\u8A08",-1),Ls={class:"fw-bolder text-accent"},ks={class:"fs-5"};function Cs(r,e,g,_,t,c){const i=h("v-loading"),l=h("SweetAlert"),V=h("HeadTitle"),$=h("router-link"),u=h("v-field"),b=h("error-message"),L=h("v-form");return p(),f(y,null,[a(i,{active:t.isLoading},null,8,["active"]),a(l),s("div",S,[s("div",A,[s("div",q,[a(V,{dialog:"Cart","dark-text":"\u8CFC\u7269\u8ECA"}),a($,{to:"/carts",class:"btn-link"},{default:w(()=>[H,v("\u4E0A\u4E00\u6B65 ")]),_:1})])]),s("div",T,[s("div",j,[s("div",B,[s("div",F,[s("div",I,[N,a(L,{class:"py-5",ref:"form",onSubmit:c.onSubmit},{default:w(({errors:o})=>[s("div",z,[D,a(u,{name:"\u59D3\u540D",id:"name",type:"text",rules:"required",class:x(["form-control",{"is-invalid":o.\u59D3\u540D}]),modelValue:t.order.user.name,"onUpdate:modelValue":e[0]||(e[0]=m=>t.order.user.name=m),placeholder:"\u8F38\u5165\u6536\u4EF6\u4EBA\u59D3\u540D"},null,8,["class","modelValue"]),a(b,{name:"\u59D3\u540D",class:"invalid-feedback"})]),s("div",M,[O,a(u,{name:"email",id:"email",type:"email",rules:"required|email",class:x(["form-control",{"is-invalid":o.email}]),modelValue:t.order.user.email,"onUpdate:modelValue":e[1]||(e[1]=m=>t.order.user.email=m),placeholder:"\u8F38\u5165Email"},null,8,["class","modelValue"]),a(b,{name:"email",class:"invalid-feedback"})]),s("div",G,[J,a(u,{name:"\u96FB\u8A71",id:"tel",type:"tel",rules:"required|numeric|min:7|max:10",class:x(["form-control",{"is-invalid":o.\u96FB\u8A71}]),modelValue:t.order.user.tel,"onUpdate:modelValue":e[2]||(e[2]=m=>t.order.user.tel=m),placeholder:"\u8F38\u5165\u6536\u4EF6\u4EBA\u96FB\u8A71"},null,8,["class","modelValue"]),a(b,{name:"\u96FB\u8A71",class:"invalid-feedback"})]),s("div",K,[Q,a(u,{name:"\u5730\u5740",id:"address",type:"text",rules:"required",class:x(["form-control",{"is-invalid":o.\u5730\u5740}]),modelValue:t.order.user.address,"onUpdate:modelValue":e[3]||(e[3]=m=>t.order.user.address=m),placeholder:"\u8F38\u5165\u6536\u4EF6\u5730\u5740"},null,8,["class","modelValue"]),a(b,{name:"\u5730\u5740",class:"invalid-feedback"})]),s("div",R,[W,a(u,{as:"textarea",name:"message",id:"message",class:"form-control",rows:"3",modelValue:t.order.message,"onUpdate:modelValue":e[4]||(e[4]=m=>t.order.message=m),placeholder:"\u53EF\u5099\u8A3B\u6536\u8CA8\u6642\u9593"},null,8,["modelValue"])]),X]),_:1},8,["onSubmit"])])])])]),s("div",Y,[s("div",Z,[ss,s("div",null,[(p(!0),f(y,null,U(t.carts,o=>(p(),f("div",{key:o.id,class:"py-3 border-bottom"},[s("div",es,[o.files[0].back===void 0?(p(),f("div",ts,[s("img",{src:o.files[0].front,class:"border img-fluid",style:{width:"400px"},alt:""},null,8,os)])):(p(),f("div",as,[s("img",{src:o.files[0].front,class:"border img-fluid me-1",style:{width:"48.5%","max-width":"200px"},alt:""},null,8,ls),s("img",{src:o.files[0].back,class:"border img-fluid",style:{width:"48.5%","max-width":"200px"},alt:""},null,8,is)]))]),s("div",ds,[s("div",rs,[s("span",ns,n(o.product.title),1),cs,s("span",ms,[v(n(o.product.width)+" x "+n(o.product.height)+"mm ",1),_s,v(" "+n(o.product.side),1)])]),s("div",hs,[s("span",null,n(o.product.material),1),us,s("span",null,n(o.product.p_qty)+" "+n(o.product.unit),1)]),s("div",ps,"$ "+n(o.product.price),1)])]))),128))])]),s("div",fs,[gs,s("div",bs,[s("div",vs,[xs,s("span",ws,"$ "+n(t.total),1)]),ys]),s("div",Vs,[$s,s("span",Ls,[v("$ "),s("span",ks,n(Math.round(t.final_total)),1)])])])])])])],64)}const qs=P(E,[["render",Cs]]);export{qs as default};
