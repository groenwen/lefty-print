import{e as m}from"./emitter.2ccbb68b.js";import{S as k}from"./ServiceTemp.a8155e43.js";import{S as z}from"./SweetAlert.f5e4cf8d.js";import{_ as L,r as f,o as l,a,d as _,b as s,t as d,x as A,F as g,u as P,y,e as u,n as h,w as C}from"./index.a95f69e0.js";import{_ as N}from"./card_img.f69fa5f3.js";const F="/lefty-print/assets/demo.7f4a3a7c.jpg";const V={data(){return{isLoading:!1,VUE_APP:"https://vue3-course-api.hexschool.io/v2/api/groen",currProd:{},currProds:[],sortProds:[],currSize:"",currSide:"",carts:[],sizeList:[],sideList:[],file:{},fileName:""}},computed:{prodId(){return this.$route.params.id}},watch:{prodId(){this.getProds()}},components:{ServiceTemp:k,SweetAlert:z},methods:{getProds(){this.isLoading=!0;const o=`${this.VUE_APP}/products/all`;this.$http.get(o).then(t=>{this.isLoading=!1;const e=t.data.products;this.currProd=e.find(n=>n.id===this.prodId),this.currSize=`${this.currProd.width}x${this.currProd.height}`,this.currSide=this.currProd.side,this.currProds=e.filter(n=>n.title===this.currProd.title),this.showSizeAndSide(),this.getSortProds()}).catch(t=>{m.emit("sweetalert",`${t.response.data.message}, error`)})},checkSizeAndSide(o,t){if(o==="size"){const e=t.split("x");this.currSize=`${e[0]}x${e[1]}`}else o==="side"&&(this.currSide=t);this.getSortProds(),this.currProd={...this.sortProds[0]},this.$router.push(`/product/${this.currProd.id}`)},getSortProds(){const o=this.currProds.filter((e,n)=>{const i=this.currSize.split("x");return e.width===Number(i[0])&&e.height===Number(i[1])&&e.side===this.currSide}),t=o.map((e,n)=>({index:n,value:e}));t.sort((e,n)=>e.value.p_qty>n.value.p_qty?1:e.value.p_qty<n.value.p_qty?-1:0),this.sortProds=t.map(e=>o[e.index])},showSizeAndSide(){const o=this.currProds.map(e=>`${e.width}x${e.height}`),t=this.currProds.map(e=>e.side);this.sizeList=o.filter((e,n)=>o.indexOf(e)===n),this.sizeList.sort(),this.sideList=t.filter((e,n)=>t.indexOf(e)===n),this.sideList.sort()},shallowEqual(o,t){const e=Object.keys(o),n=Object.keys(t);if(e.length!==n.length)return!1;for(let i=0;i<=e.length;i++){const c=o[e[i]],p=t[n[i]];if(c!==p)return!1}return!0},addToCart(){this.isLoading=!0;const o=`${this.VUE_APP}/cart`;this.$http.post(o,{data:{product_id:this.currProd.id,qty:1,files:[{id:0,front:F}]}}).then(t=>{this.isLoading=!1,m.emit("cartCount"),m.emit("sweetalert",`${t.data.message}, success`)}).catch(t=>{this.isLoading=!1,m.emit("sweetalert",`${t.response.data.message}, error`)})},choseFile(o){this.file=o.target.files[0],this.fileName=this.file.name,console.log(this.fileName),console.log(this.file.name.length>0,"{}")},uploadFile(){const o="https://script.google.com/macros/s/AKfycbwuS2QeYvec72MZrQTPElC07XE1ntHm3tepY2ySf44qWRNvy_J9vADKZveVQ93dzhO8/exec";this.$http.post(o,this.file,{headers:{"content-type":"text/plain; charset=utf-8"}}).then(t=>{console.log(t)}).catch(t=>{console.log(t)})}},mounted(){this.getProds()}},q={class:"mb-5 bg-gray100"},T={class:"container px-4 px-md-0 py-5 py-sm-4"},E={class:"row justify-content-between align-items-center"},$={class:"order-md-1 order-2 col-md-5 col-12"},I={class:"mb-4 d-inline-block px-3 py-2 fs-8 lh-1 text-primary bg-white rounded-pill"},O={class:"mb-4 fs-2"},U={class:"mb-4"},j={class:"d-flex align-items-center text-primary"},B=s("span",{class:"material-symbols-sharp fs-2 me-3"},"calendar_month",-1),Q={class:"lh-1"},D={class:"order-md-2 order-1 col-md-5 col-12"},K=s("img",{class:"img-fluid",src:N,alt:""},null,-1),M=[K],Y={class:"container"},Z={class:"mb-5"},H=s("span",{class:"me-3 mb-1 fs-7 text-secondary"},"\u5C3A\u5BF8\u2003\xA0",-1),J=["onClick"],R={class:"mb-5"},W=s("span",{class:"me-3 mb-1 fs-7 text-secondary"},"\u55AE/\u96D9\u9762",-1),X=["onClick"],G={class:"mb-5 position-relative",style:{"min-height":"100px"}},ss={class:"border border-light bg-gray100 px-md-4 px-2 py-3"},ts={class:"table table-borderless table-hover text-center"},es=s("thead",null,[s("tr",{class:"text-secondary fs-7"},[s("th",{class:"text-start ps-md-4 fw-normal",width:"16%"},"\u5C3A\u5BF8"),s("th",{class:"fw-normal",width:"16%"},"\u55AE / \u96D9\u9762"),s("th",{class:"fw-normal"},"\u6750\u8CEA"),s("th",{class:"fw-normal"},"\u6578\u91CF"),s("th",{class:"fw-normal"},"\u50F9\u683C")])],-1),rs={class:"text-start text-secondary ps-md-4"},is={class:"text-secondary"},os={class:"mb-5 text-end text-secondary"},ds={class:"mb-5"},ns={for:"formFile",class:"p-4 w-100 text-secondary text-center bg-gray100 border-dash"},cs={key:0},ls=s("span",{class:"me-2 material-symbols-sharp fs-1 align-middle"},"cloud_upload",-1),as={key:1},hs=s("span",{class:"me-2 material-symbols-sharp fs-1 align-middle"},"cloud_upload",-1),us={class:"mb-5 d-flex justify-content-end align-items-center"},_s={class:"text-primary me-5"},ps={class:"fs-2 fw-bold"},ms=s("span",{class:"material-symbols-sharp align-text-bottom"},"shopping_cart",-1),fs={class:"mt-8 py-7 bg-gray200"};function gs(o,t,e,n,i,c){const p=f("v-loading"),v=f("SweetAlert"),x=f("router-link"),S=f("ServiceTemp");return l(),a(g,null,[_(p,{active:i.isLoading},null,8,["active"]),_(v),s("div",q,[s("div",T,[s("div",E,[s("div",$,[s("span",I,d(i.currProd.category),1),s("h1",O,d(i.currProd.title),1),s("p",U,d(i.currProd.content),1),s("div",j,[B,s("span",Q,d(i.currProd.description),1)])]),s("div",D,[s("div",{class:"mb-4 mb-md-0 bg-cover h-100",style:A({backgroundImage:`url(${i.currProd.imageUrl})`})},M,4)])])])]),s("div",Y,[s("div",Z,[H,(l(!0),a(g,null,P(i.sizeList,(r,b)=>(l(),a("a",{href:"#",key:`size${b}`,onClick:y(w=>c.checkSizeAndSide("size",r),["prevent"]),class:h(["btn btn-sm rounded-pill me-3",[this.currSize===r?"btn-dark":"btn-outline-secondary"]])},d(r),11,J))),128))]),s("div",R,[W,(l(!0),a(g,null,P(i.sideList,(r,b)=>(l(),a("a",{href:"#",key:`side${b}`,onClick:y(w=>c.checkSizeAndSide("side",r),["prevent"]),class:h(["btn btn-sm rounded-pill me-3",[this.currProd.side===r?"btn-dark":"btn-outline-secondary"]])},d(r),11,X))),128))]),s("div",G,[_(p,{active:i.isLoading},null,8,["active"]),s("div",ss,[s("table",ts,[es,s("tbody",null,[(l(!0),a(g,null,P(i.sortProds,r=>(l(),a("tr",{key:r.id,class:h([[this.currProd.id===r.id?"bg-light":"bg-white"],"position-relative"])},[s("th",rs,d(r.width)+"x"+d(r.height)+"mm",1),s("td",is,d(r.side),1),s("td",{class:h({"text-primary":this.currProd.id===r.id})},d(r.material),3),s("td",{class:h({"text-primary":this.currProd.id===r.id})},d(r.p_qty)+" "+d(r.unit),3),s("td",{class:h({"text-primary":this.currProd.id===r.id})},[u(" $"),_(x,{to:`/product/${r.id}`,class:h(["fw-bolder stretched-link",{"text-dark":this.currProd.id!==r.id}])},{default:C(()=>[u(d(r.price),1)]),_:2},1032,["to","class"])],2)],2))),128))])])])]),s("p",os,d(i.currProd.width)+"x"+d(i.currProd.height)+"mm \uFF0F "+d(i.currProd.side)+" \uFF0F "+d(i.currProd.material)+" \uFF0F "+d(i.currProd.p_qty)+" \u5F35",1),s("div",ds,[s("form",{onSubmit:t[1]||(t[1]=y((...r)=>c.uploadFile&&c.uploadFile(...r),["prevent"]))},[s("input",{class:"inputfile",type:"file",id:"formFile",onChange:t[0]||(t[0]=(...r)=>c.choseFile&&c.choseFile(...r))},null,32),s("label",ns,[i.fileName.length<=0?(l(),a("span",cs,[ls,u("\u4E0A\u50B3\u6A94\u6848")])):(l(),a("span",as,[hs,u(d(i.fileName),1)]))])],32)]),s("div",us,[s("span",_s,[u("NT$ "),s("span",ps,d(i.currProd.price),1)]),s("a",{href:"#",class:h(["btn btn-accent",{disabled:this.file.name===void 0}]),onClick:t[2]||(t[2]=y(r=>c.addToCart(),["prevent"]))},[ms,u(" \u52A0\u5165\u8CFC\u7269\u8ECA ")],2)])]),s("div",fs,[_(S),u("> ")])],64)}const Ss=L(V,[["render",gs]]);export{Ss as default};
