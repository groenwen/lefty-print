import{e as d}from"./emitter.2ccbb68b.js";import{S as L}from"./SweetAlert.d2d530d2.js";import{_ as k}from"./people01.1d41a424.js";import{_ as C,r as h,o as p,a as f,d as l,b as s,w,F as y,u as P,t as n,e as v,n as x}from"./index.6acf77a9.js";const U={data(){return{VUE_APP:"https://vue3-course-api.hexschool.io/v2/api/groen",isLoading:!1,total:0,final_total:0,carts:[],order:{user:{name:"",email:"",tel:"",address:""},message:""}}},components:{SweetAlert:L},methods:{getCarts(){this.isLoading=!0;const r=`${this.VUE_APP}/cart`;this.$http.get(r).then(e=>{console.log(e.data.data),this.isLoading=!1,this.total=e.data.data.total,this.final_total=e.data.data.final_total;const g=e.data.data.carts,_=[];g.forEach(t=>{if(t.files===void 0||t.files.length<=1)_.push(t);else{const c=t.files.length;for(let i=0;i<c;i++){const o={...t};o.files=[t.files[i]],o.files[0].id=i+1,_.push(o)}}}),this.carts=_,d.emit("cartCount")}).catch(e=>{this.isLoading=!1,d.emit("sweetalert",`${e.response.data.message}, error`)})},clearCarts(){this.isLoading=!0;const r=`${this.VUE_APP}/carts`;this.$http.delete(r).then(e=>{this.isLoading=!1,d.emit("sweetalert",`${e.data.message}, success`),this.getCarts()}).catch(e=>{this.isLoading=!1,d.emit("sweetalert",`${e.response.data.message}, error`)})},delCart(r,e){this.isLoading=!0;const g=`${this.VUE_APP}/cart`;this.$http.get(g).then(_=>{const c=_.data.data.carts.find(i=>i.product_id===r.product_id);if(c.files===void 0||c.files.length<=1){const i=`https://vue3-course-api.hexschool.io/v2/api/groen/cart/${r.id}`;this.$http.delete(i).then(o=>{this.isLoading=!1,d.emit("sweetalert",`${o.data.message}, success`),this.getCarts()}).catch(o=>{this.isLoading=!1,d.emit("sweetalert",`${o.response.data.message}, error`)})}else{c.files.splice(e-1,1);const i=`https://vue3-course-api.hexschool.io/v2/api/groen/cart/${r.id}`;this.$http.put(i,{data:{product_id:c.id,qty:1,files:c.files}}).then(o=>{this.isLoading=!1,d.emit("sweetalert",`${o.data.message}, success`),this.getCarts()}).catch(o=>{this.isLoading=!1,d.emit("sweetalert",`${o.response.data.message}, error`)})}}).catch(_=>{this.isLoading=!1,d.emit("sweetalert",`${_.response.data.message}, error`)})},onSubmit(){this.isLoading=!0;const r=`${this.VUE_APP}/order`;this.$http.post(r,{data:{...this.order}}).then(e=>{this.isLoading=!1,d.emit("sweetalert",`${e.data.message}, success`),this.$router.push(`/OrderCheckout/${e.data.orderId}`)}).catch(e=>{this.isLoading=!1,d.emit("sweetalert",`${e.response.data.message}, error`)})}},mounted(){this.getCarts()}},E={class:"container mt-5 pb-8"},S={class:"row mb-3"},A={class:"col-md-8 d-flex justify-content-between align-items-end"},q=s("div",{class:"d-flex align-items-end"},[s("img",{class:"me-3 headtitle-img",src:k,alt:""}),s("div",null,[s("span",{class:"d-inline-block mb-3 px-4 py-2 text-white lh-1 bg-primary rounded-pill position-relative dialog"},"Cart"),s("h2",{class:"mb-0 fw-bolder"},"\u8CFC\u7269\u8ECA")])],-1),F=s("span",{class:"material-symbols-outlined align-text-bottom"},"arrow_back",-1),j={class:"row g-lg-5"},B={class:"order-2 order-md-1 col-md-8"},I={class:"bg-gray100 pt-6 pb-5"},N={class:"row justify-content-center"},z={class:"col-xl-9 col-lg-8 col-10"},D=s("h4",{class:"fw-bolder text-primary"}," \u6536\u4EF6\u4EBA ",-1),M={class:"mb-4"},O=s("label",{for:"name",class:"form-label fs-7"},"\u59D3\u540D",-1),T={class:"mb-4"},G=s("label",{for:"email",class:"form-label fs-7"},"Email",-1),H={class:"mb-4"},J=s("label",{for:"tel",class:"form-label fs-7"},"\u96FB\u8A71",-1),K={class:"mb-4"},Q=s("label",{for:"address",class:"form-label fs-7"},"\u5730\u5740",-1),R={class:"mb-5"},W=s("label",{for:"message",class:"form-label fs-7"},"\u8A02\u55AE\u5099\u8A3B",-1),X=s("div",{class:"d-grid col-md-7 mx-auto mb-5"},[s("button",{type:"submit",class:"btn btn-accent"},"\u7D50\u5E33")],-1),Y={class:"order-1 order-md-2 col-md-4"},Z={class:"mb-5 bg-gray-100"},ss=s("div",{class:"px-3 py-2 bg-gray100"},[s("span",{class:"text-secondary small"},"\u9805\u76EE")],-1),es={class:"mb-3"},ts={key:0},as=["src"],os={key:1,class:"d-flex"},ls=["src"],is=["src"],ds={class:"px-2 d-flex justify-content-between align-items-center"},rs={class:""},ns={class:"fw-bold mb-2"},cs=s("br",null,null,-1),ms={class:"text-secondary fs-7"},_s=s("br",null,null,-1),hs={class:"text-secondary fs-7"},us=s("br",null,null,-1),ps={class:"text-nowrap fw-bold"},fs={class:""},gs=s("div",{class:"mb-3 px-3 py-2 bg-gray100"},[s("span",{class:"text-secondary small"},"\u8A02\u55AE\u6458\u8981")],-1),bs={class:"px-3"},vs={class:"mb-2 d-flex"},xs=s("span",{class:"me-auto text-secondary small"},"\u5C0F\u8A08",-1),ws={class:"fw-bold"},ys=s("div",{class:"mb-2 d-flex"},[s("span",{class:"me-auto text-secondary small"},"\u904B\u8CBB"),s("span",null,"\u514D\u904B\u8CBB")],-1),Vs={class:"px-3 d-flex"},$s=s("span",{class:"me-auto text-secondary small"},"\u7E3D\u8A08",-1),Ls={class:"fw-bolder text-accent"},ks={class:"fs-5"};function Cs(r,e,g,_,t,c){const i=h("v-loading"),o=h("SweetAlert"),V=h("router-link"),u=h("v-field"),b=h("error-message"),$=h("v-form");return p(),f(y,null,[l(i,{active:t.isLoading},null,8,["active"]),l(o),s("div",E,[s("div",S,[s("div",A,[q,l(V,{to:"/carts",class:"btn-link"},{default:w(()=>[F,v("\u4E0A\u4E00\u6B65 ")]),_:1})])]),s("div",j,[s("div",B,[s("div",I,[s("div",N,[s("div",z,[D,l($,{class:"py-5",ref:"form",onSubmit:c.onSubmit},{default:w(({errors:a})=>[s("div",M,[O,l(u,{name:"\u59D3\u540D",id:"name",type:"text",rules:"required",class:x(["form-control",{"is-invalid":a.\u59D3\u540D}]),modelValue:t.order.user.name,"onUpdate:modelValue":e[0]||(e[0]=m=>t.order.user.name=m),placeholder:"\u8F38\u5165\u6536\u4EF6\u4EBA\u59D3\u540D"},null,8,["class","modelValue"]),l(b,{name:"\u59D3\u540D",class:"invalid-feedback"})]),s("div",T,[G,l(u,{name:"email",id:"email",type:"email",rules:"required|email",class:x(["form-control",{"is-invalid":a.email}]),modelValue:t.order.user.email,"onUpdate:modelValue":e[1]||(e[1]=m=>t.order.user.email=m),placeholder:"\u8F38\u5165Email"},null,8,["class","modelValue"]),l(b,{name:"email",class:"invalid-feedback"})]),s("div",H,[J,l(u,{name:"\u96FB\u8A71",id:"tel",type:"tel",rules:"required|numeric|min:7|max:10",class:x(["form-control",{"is-invalid":a.\u96FB\u8A71}]),modelValue:t.order.user.tel,"onUpdate:modelValue":e[2]||(e[2]=m=>t.order.user.tel=m),placeholder:"\u8F38\u5165\u6536\u4EF6\u4EBA\u96FB\u8A71"},null,8,["class","modelValue"]),l(b,{name:"\u96FB\u8A71",class:"invalid-feedback"})]),s("div",K,[Q,l(u,{name:"\u5730\u5740",id:"address",type:"text",rules:"required",class:x(["form-control",{"is-invalid":a.\u5730\u5740}]),modelValue:t.order.user.address,"onUpdate:modelValue":e[3]||(e[3]=m=>t.order.user.address=m),placeholder:"\u8F38\u5165\u6536\u4EF6\u5730\u5740"},null,8,["class","modelValue"]),l(b,{name:"\u5730\u5740",class:"invalid-feedback"})]),s("div",R,[W,l(u,{as:"textarea",name:"message",id:"message",class:"form-control",rows:"3",modelValue:t.order.message,"onUpdate:modelValue":e[4]||(e[4]=m=>t.order.message=m),placeholder:"\u53EF\u5099\u8A3B\u6536\u8CA8\u6642\u9593"},null,8,["modelValue"])]),X]),_:1},8,["onSubmit"])])])])]),s("div",Y,[s("div",Z,[ss,s("div",null,[(p(!0),f(y,null,P(t.carts,a=>(p(),f("div",{key:a.id,class:"py-3 border-bottom"},[s("div",es,[a.files[0].back===void 0?(p(),f("div",ts,[s("img",{src:a.files[0].front,class:"border img-fluid",style:{width:"400px"},alt:""},null,8,as)])):(p(),f("div",os,[s("img",{src:a.files[0].front,class:"border img-fluid me-1",style:{width:"48.5%","max-width":"200px"},alt:""},null,8,ls),s("img",{src:a.files[0].back,class:"border img-fluid",style:{width:"48.5%","max-width":"200px"},alt:""},null,8,is)]))]),s("div",ds,[s("div",rs,[s("span",ns,n(a.product.title),1),cs,s("span",ms,[v(n(a.product.width)+" x "+n(a.product.height)+"mm ",1),_s,v(" "+n(a.product.side),1)])]),s("div",hs,[s("span",null,n(a.product.material),1),us,s("span",null,n(a.product.p_qty)+" "+n(a.product.unit),1)]),s("div",ps,"$ "+n(a.product.price),1)])]))),128))])]),s("div",fs,[gs,s("div",bs,[s("div",vs,[xs,s("span",ws,"$ "+n(t.total),1)]),ys]),s("div",Vs,[$s,s("span",Ls,[v("$ "),s("span",ks,n(Math.round(t.final_total)),1)])])])])])])],64)}const As=C(U,[["render",Cs]]);export{As as default};
